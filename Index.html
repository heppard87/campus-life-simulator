<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ff6b9d">
    <meta name="description" content="Campus Life Simulator - Multiplayer Online Game by Chris Heppard">
    <title>Campus Life Simulator - Multiplayer Edition</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Socket.io Client -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <style>
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                    DESIGN SYSTEM & VARIABLES                  ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        :root {
            --pink-100: #ffe5ec;
            --pink-300: #ffc2d1;
            --pink-500: #ff6b9d;
            --pink-700: #ff0055;
            --purple-100: #f3e5f5;
            --purple-300: #e0aaff;
            --purple-500: #c77dff;
            --purple-700: #9d4edd;
            --purple-900: #5a189a;
            --gold: #ffd700;
            --success: #4ade80;
            --warning: #fbbf24;
            --danger: #f87171;
            --glass-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.15);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.1);
            --shadow-md: 0 8px 24px rgba(0,0,0,0.15);
            --shadow-lg: 0 16px 48px rgba(0,0,0,0.2);
            --shadow-glow: 0 0 30px rgba(255,107,157,0.4);
            --transition-base: 300ms ease;
            --transition-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
            line-height: 1.6;
        }

        body.light-theme {
            background: linear-gradient(135deg, #ffeef8 0%, #f3e5f5 50%, #ffe5ec 100%);
            color: #333;
        }

        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(var(--pink-500), var(--purple-500));
            border-radius: 10px;
            border: 3px solid transparent;
            background-clip: content-box;
        }

        ::selection {
            background: var(--pink-500);
            color: white;
        }

        /* Particle Canvas */
        #particles-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        /* Utility Classes */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow-md);
        }

        .card-3d {
            transform-style: preserve-3d;
            transition: transform var(--transition-base);
        }

        .card-3d:hover {
            transform: translateY(-8px) rotateX(5deg) scale(1.02);
        }

        .neon-glow {
            box-shadow: 0 0 10px var(--pink-500), 0 0 20px var(--pink-500), 0 0 40px var(--purple-500);
            animation: neon-pulse 2s infinite alternate;
        }

        @keyframes neon-pulse {
            from { box-shadow: 0 0 10px var(--pink-500), 0 0 20px var(--pink-500); }
            to { box-shadow: 0 0 20px var(--pink-500), 0 0 40px var(--purple-500), 0 0 60px var(--purple-500); }
        }

        .float {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 50px;
            font-family: inherit;
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--pink-500), var(--purple-500));
            color: white;
            box-shadow: 0 4px 15px rgba(255,107,157,0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.9);
            color: var(--purple-900);
        }

        .btn-ghost {
            background: transparent;
            border: 2px solid currentColor;
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f87171, #ef4444);
            color: white;
        }

        /* App Container */
        .app-container {
            position: relative;
            z-index: 1;
            max-width: 1920px;
            margin: 0 auto;
            padding: 1rem;
            display: grid;
            grid-template-rows: auto 1fr auto;
            min-height: 100vh;
            gap: 1rem;
        }

        /* Header */
        .header {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .header-top {
            background: linear-gradient(135deg, var(--pink-500), var(--purple-500));
            padding: 1.5rem;
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            font-family: 'Pacifico', cursive;
            font-size: 2rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.2);
            border-radius: 50px;
            font-size: 0.85rem;
        }

        .connection-status.connected {
            background: rgba(74, 222, 128, 0.3);
        }

        .connection-status.disconnected {
            background: rgba(248, 113, 113, 0.3);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .login-section {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .input-group {
            position: relative;
        }

        .input-group input, .input-group select {
            padding: 0.75rem 1rem;
            padding-left: 2.5rem;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50px;
            background: rgba(255,255,255,0.9);
            font-family: inherit;
            font-size: 0.9rem;
            color: var(--purple-900);
            outline: none;
            transition: all var(--transition-base);
            min-width: 150px;
        }

        .input-group input:focus, .input-group select:focus {
            border-color: white;
            box-shadow: 0 0 0 3px rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .input-group i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--purple-500);
        }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            padding: 1rem;
            background: var(--glass-bg);
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            flex-wrap: wrap;
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            min-width: 80px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--pink-500), var(--purple-500));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        /* Main Content Grid */
        .main-content {
            display: grid;
            grid-template-columns: 320px 1fr 380px;
            gap: 1.5rem;
            align-items: start;
        }

        @media (max-width: 1400px) {
            .main-content {
                grid-template-columns: 280px 1fr 320px;
            }
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        /* Cards */
        .card {
            background: var(--glass-bg);
            border-radius: 20px;
            border: 1px solid var(--glass-border);
            overflow: hidden;
            transition: all var(--transition-base);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            border-color: rgba(255,255,255,0.3);
        }

        .card-header {
            background: linear-gradient(135deg, var(--pink-500), var(--purple-500));
            padding: 1rem 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: space-between;
        }

        .card-body {
            padding: 1.5rem;
        }

        /* Avatar Display */
        .profile-avatar {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            border: 4px solid white;
            box-shadow: var(--shadow-md);
            position: relative;
            cursor: pointer;
            transition: all var(--transition-base);
            background: linear-gradient(135deg, var(--pink-300), var(--purple-300));
        }

        .profile-avatar:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-glow);
        }

        .profile-avatar::after {
            content: '‚úèÔ∏è';
            position: absolute;
            bottom: 0;
            right: 0;
            background: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            border: 3px solid var(--pink-300);
            box-shadow: var(--shadow-sm);
        }

        /* Activity Grid */
        .activity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .activity-card {
            background: rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 1.5rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-base);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .activity-card:hover {
            transform: translateY(-5px);
            border-color: var(--pink-500);
            box-shadow: var(--shadow-glow);
        }

        .activity-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .activity-title {
            font-weight: 700;
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }

        .activity-stats {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-bottom: 0.75rem;
        }

        .activity-btn {
            width: 100%;
            padding: 0.5rem;
            background: linear-gradient(135deg, var(--pink-500), var(--purple-500));
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            opacity: 0;
            transform: translateY(10px);
            transition: all var(--transition-base);
        }

        .activity-card:hover .activity-btn {
            opacity: 1;
            transform: translateY(0);
        }

        /* Chat System */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .message {
            max-width: 85%;
            padding: 0.75rem 1rem;
            border-radius: 18px;
            position: relative;
            animation: message-pop 0.3s var(--transition-bounce);
            word-wrap: break-word;
        }

        @keyframes message-pop {
            0% { opacity: 0; transform: scale(0.8) translateY(10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .message-incoming {
            align-self: flex-start;
            background: rgba(255,255,255,0.9);
            color: #333;
            border-bottom-left-radius: 4px;
        }

        .message-outgoing {
            align-self: flex-end;
            background: linear-gradient(135deg, var(--pink-500), var(--purple-500));
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-system {
            align-self: center;
            background: rgba(255,255,255,0.2);
            color: #fff;
            font-size: 0.85rem;
            font-style: italic;
            padding: 0.5rem 1rem;
            border-radius: 50px;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .message-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            background: linear-gradient(135deg, var(--pink-300), var(--purple-300));
        }

        .chat-input-area {
            padding: 1rem;
            background: rgba(255,255,255,0.05);
            display: flex;
            gap: 0.5rem;
            align-items: center;
            border-top: 1px solid var(--glass-border);
        }

        .chat-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 25px;
            background: rgba(255,255,255,0.9);
            font-family: inherit;
            outline: none;
            transition: all var(--transition-base);
        }

        .chat-input:focus {
            border-color: var(--pink-500);
            box-shadow: 0 0 0 3px rgba(255,107,157,0.2);
        }

        .emoji-picker {
            position: absolute;
            bottom: 70px;
            right: 20px;
            background: white;
            border-radius: 15px;
            padding: 10px;
            box-shadow: var(--shadow-lg);
            display: none;
            grid-template-columns: repeat(8, 1fr);
            gap: 5px;
            z-index: 1000;
            border: 2px solid var(--pink-300);
            max-width: 300px;
        }

        .emoji-picker.show {
            display: grid;
        }

        .emoji-option {
            cursor: pointer;
            padding: 5px;
            text-align: center;
            border-radius: 8px;
            transition: all 0.2s;
            font-size: 1.3rem;
        }

        .emoji-option:hover {
            background: var(--pink-100);
            transform: scale(1.2);
        }

        /* Online Users List */
        .online-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .online-user {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .online-user:hover {
            background: rgba(255,255,255,0.2);
            border-color: var(--pink-500);
            transform: translateX(5px);
        }

        .online-user .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: linear-gradient(135deg, var(--pink-300), var(--purple-300));
            border: 2px solid white;
        }

        .online-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
            border: 2px solid white;
            margin-left: -15px;
            margin-top: 25px;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .user-status {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        /* Avatar Creator Modal */
        .avatar-creator {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .avatar-preview-large {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            margin: 0 auto 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8rem;
            background: linear-gradient(135deg, var(--pink-300), var(--purple-300));
            border: 5px solid white;
            box-shadow: var(--shadow-lg);
        }

        .customization-section {
            margin-bottom: 1.5rem;
        }

        .customization-title {
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--pink-500);
        }

        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 0.5rem;
        }

        .option-btn {
            aspect-ratio: 1;
            border: 2px solid transparent;
            border-radius: 12px;
            background: rgba(255,255,255,0.1);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .option-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.1);
        }

        .option-btn.selected {
            border-color: var(--pink-500);
            background: rgba(255,107,157,0.2);
            box-shadow: 0 0 10px rgba(255,107,157,0.3);
        }

        .color-picker {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .color-option:hover {
            transform: scale(1.2);
        }

        .color-option.selected {
            border-color: white;
            box-shadow: 0 0 0 3px var(--pink-500);
        }

        /* Achievement Toast */
        .achievement-toast {
            position: fixed;
            top: 100px;
            right: -400px;
            background: linear-gradient(135deg, var(--gold), #ffed4e);
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: 10000;
            transition: right 0.5s var(--transition-bounce);
            max-width: 350px;
        }

        .achievement-toast.show {
            right: 1.5rem;
        }

        /* Modal System */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            opacity: 0;
            transition: opacity var(--transition-base);
            padding: 1rem;
            overflow-y: auto;
        }

        .modal-overlay.show {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 24px;
            padding: 2rem;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid var(--pink-500);
            box-shadow: var(--shadow-glow);
            transform: scale(0.9);
            transition: transform var(--transition-base);
            position: relative;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.1);
            transform: rotate(90deg);
        }

        /* Quest Panel */
        .quest-item {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid var(--pink-500);
            cursor: pointer;
            transition: all 0.3s;
        }

        .quest-item:hover {
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
        }

        .quest-item.completed {
            border-left-color: var(--success);
            opacity: 0.7;
        }

        .quest-title {
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .quest-reward {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .quest-progress {
            background: rgba(255,255,255,0.2);
            height: 6px;
            border-radius: 3px;
            margin-top: 0.5rem;
            overflow: hidden;
        }

        .quest-progress-fill {
            background: linear-gradient(90deg, var(--pink-500), var(--purple-500));
            height: 100%;
            transition: width 0.5s;
        }

        /* Inventory Grid */
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 1rem;
        }

        .inventory-item {
            aspect-ratio: 1;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            padding: 0.5rem;
        }

        .inventory-item:hover {
            border-color: var(--pink-500);
            transform: translateY(-3px);
        }

        .inventory-item .item-icon {
            font-size: 2rem;
            margin-bottom: 0.25rem;
        }

        .inventory-item .item-name {
            font-size: 0.7rem;
            text-align: center;
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 700;
            box-shadow: var(--shadow-lg);
            z-index: 10000;
            transition: transform 0.3s var(--transition-bounce);
            max-width: 90%;
            text-align: center;
        }

        .notification.show {
            transform: translateX(-50%) translateY(0);
        }

        .notification.success { background: var(--success); color: white; }
        .notification.error { background: var(--danger); color: white; }
        .notification.warning { background: var(--warning); color: #333; }
        .notification.info { background: var(--info); color: white; }

        /* Footer */
        .footer {
            text-align: center;
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--pink-500), var(--purple-500));
            border-radius: 20px;
            font-weight: 700;
            position: relative;
            overflow: hidden;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header-top {
                flex-direction: column;
                text-align: center;
            }
            
            .activity-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .avatar-creator {
                grid-template-columns: 1fr;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: var(--pink-500);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            width: fit-content;
            margin: 0.5rem 0;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--pink-500);
            border-radius: 50%;
            animation: typing-bounce 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing-bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* Mini Profile Popup */
        .mini-profile {
            position: absolute;
            background: white;
            border-radius: 16px;
            padding: 1rem;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            min-width: 200px;
            display: none;
            color: #333;
        }

        .mini-profile.show {
            display: block;
            animation: pop-in 0.3s var(--transition-bounce);
        }

        @keyframes pop-in {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="light-theme">
    <canvas id="particles-canvas"></canvas>

    <!-- Achievement Toast -->
    <div class="achievement-toast" id="achievementToast">
        <div style="font-size: 2.5rem;">üèÜ</div>
        <div>
            <div style="font-weight: 800; color: #333; font-size: 1.1rem;">Achievement Unlocked!</div>
            <div style="color: #666;" id="achievementName">First Steps</div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-top">
                <div class="logo" onclick="toggleTheme()">
                    <span>üéì</span>
                    <span>Campus Life</span>
                </div>
                
                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot"></span>
                    <span id="connectionText">Connecting...</span>
                </div>

                <div class="login-section" id="loginSection">
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="playerName" placeholder="Your Name" maxlength="12">
                    </div>
                    <div class="input-group">
                        <i class="fas fa-venus-mars"></i>
                        <select id="playerGender">
                            <option value="">Select Gender</option>
                            <option value="female">Female</option>
                            <option value="male">Male</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary" onclick="enterCampus()">
                        <i class="fas fa-door-open"></i>
                        Enter Campus
                    </button>
                </div>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar glass">
                <div class="stat-item">
                    <div class="stat-value" id="statCoins">500</div>
                    <div class="stat-label">ü™ô Coins</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statGems">10</div>
                    <div class="stat-label">üíé Gems</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statLevel">1</div>
                    <div class="stat-label">‚≠ê Level</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statEnergy">100</div>
                    <div class="stat-label">‚ö° Energy</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statHappy">85</div>
                    <div class="stat-label">üòä Happy</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="statGPA">3.5</div>
                    <div class="stat-label">üìö GPA</div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content" id="mainContent" style="opacity: 0.5; pointer-events: none;">
            <!-- Left Sidebar -->
            <aside class="sidebar-left">
                <!-- Profile Card -->
                <div class="card card-3d">
                    <div class="card-header">
                        <span><i class="fas fa-id-card"></i> My Profile</span>
                        <button class="btn btn-ghost" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;" onclick="openAvatarCreator()">
                            Edit
                        </button>
                    </div>
                    <div class="card-body" style="text-align: center;">
                        <div class="profile-avatar float" id="profileAvatar" onclick="openAvatarCreator()">
                            üë§
                        </div>
                        <h3 id="displayName" style="margin-bottom: 0.25rem;">Guest</h3>
                        <p style="opacity: 0.8; font-size: 0.9rem;" id="playerTitle">Freshman Student</p>
                        
                        <div style="margin-top: 1rem;">
                            <div style="background: rgba(255,255,255,0.2); height: 10px; border-radius: 5px; overflow: hidden;">
                                <div id="xpBar" style="background: linear-gradient(90deg, var(--pink-500), var(--purple-500)); height: 100%; width: 0%; transition: width 0.5s;"></div>
                            </div>
                            <p style="font-size: 0.8rem; margin-top: 0.5rem;">Level <span id="levelDisplay">1</span> - <span id="xpText">0/100</span> XP</p>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-top: 1.5rem;">
                            <div style="text-align: center; padding: 0.75rem; background: rgba(255,255,255,0.1); border-radius: 12px;">
                                <div style="font-size: 1.5rem;">üß†</div>
                                <div style="font-size: 0.75rem; opacity: 0.8;">INT</div>
                                <div style="font-weight: 700;" id="skillInt">10</div>
                            </div>
                            <div style="text-align: center; padding: 0.75rem; background: rgba(255,255,255,0.1); border-radius: 12px;">
                                <div style="font-size: 1.5rem;">üí¨</div>
                                <div style="font-size: 0.75rem; opacity: 0.8;">CHR</div>
                                <div style="font-weight: 700;" id="skillChr">10</div>
                            </div>
                            <div style="text-align: center; padding: 0.75rem; background: rgba(255,255,255,0.1); border-radius: 12px;">
                                <div style="font-size: 1.5rem;">‚ö°</div>
                                <div style="font-size: 0.75rem; opacity: 0.8;">ATH</div>
                                <div style="font-weight: 700;" id="skillAth">10</div>
                            </div>
                            <div style="text-align: center; padding: 0.75rem; background: rgba(255,255,255,0.1); border-radius: 12px;">
                                <div style="font-size: 1.5rem;">üé®</div>
                                <div style="font-size: 0.75rem; opacity: 0.8;">CRE</div>
                                <div style="font-weight: 700;" id="skillCre">10</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Daily Quests -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <span><i class="fas fa-tasks"></i> Daily Quests</span>
                        <span style="font-size: 0.85rem; opacity: 0.9;">3/3</span>
                    </div>
                    <div class="card-body">
                        <div class="quest-item" id="quest1" onclick="claimQuest(1)">
                            <div class="quest-title">üìö Study for 30 minutes</div>
                            <div class="quest-reward">Reward: 50 ü™ô + 10 XP</div>
                            <div class="quest-progress">
                                <div class="quest-progress-fill" style="width: 60%"></div>
                            </div>
                        </div>
                        <div class="quest-item" id="quest2" onclick="claimQuest(2)">
                            <div class="quest-title">‚òï Chat with 3 friends</div>
                            <div class="quest-reward">Reward: 30 ü™ô + 5 CHR</div>
                            <div class="quest-progress">
                                <div class="quest-progress-fill" style="width: 33%"></div>
                            </div>
                        </div>
                        <div class="quest-item completed" id="quest3">
                            <div class="quest-title">‚úÖ Daily Login</div>
                            <div class="quest-reward">Claimed: 100 ü™ô</div>
                            <div class="quest-progress">
                                <div class="quest-progress-fill" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Inventory -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <span><i class="fas fa-backpack"></i> Inventory</span>
                    </div>
                    <div class="card-body">
                        <div class="inventory-grid" id="inventoryGrid">
                            <div class="inventory-item">
                                <div class="item-icon">üìö</div>
                                <div class="item-name">Textbook</div>
                            </div>
                            <div class="inventory-item">
                                <div class="item-icon">‚òï</div>
                                <div class="item-name">Coffee</div>
                            </div>
                            <div class="inventory-item">
                                <div class="item-icon">üéÅ</div>
                                <div class="item-name">Gift Box</div>
                            </div>
                            <div class="inventory-item">
                                <div class="item-icon">üé´</div>
                                <div class="item-name">Ticket</div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Center Content -->
            <section class="center-content">
                <!-- Activity Center -->
                <div class="card">
                    <div class="card-header">
                        <span><i class="fas fa-school"></i> Campus Activity Center</span>
                        <button class="btn btn-ghost" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;" onclick="showActivityHelp()">
                            <i class="fas fa-question-circle"></i>
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="activity-grid">
                            <div class="activity-card" onclick="doActivity('study')">
                                <span class="activity-icon">üìö</span>
                                <div class="activity-title">Study Session</div>
                                <div class="activity-stats">-10‚ö° +15üß† +20 XP</div>
                                <button class="activity-btn">JOIN</button>
                            </div>
                            <div class="activity-card" onclick="doActivity('coffee')">
                                <span class="activity-icon">‚òï</span>
                                <div class="activity-title">Coffee Chat</div>
                                <div class="activity-stats">-5‚ö° +10üí¨ +15 XP</div>
                                <button class="activity-btn">JOIN</button>
                            </div>
                            <div class="activity-card" onclick="doActivity('club')">
                                <span class="activity-icon">üéµ</span>
                                <div class="activity-title">Club Meeting</div>
                                <div class="activity-stats">-10‚ö° +15üí¨ +20 XP</div>
                                <button class="activity-btn">JOIN</button>
                            </div>
                            <div class="activity-card" onclick="doActivity('sports')">
                                <span class="activity-icon">üèÄ</span>
                                <div class="activity-title">Sports Event</div>
                                <div class="activity-stats">-20‚ö° +15‚ö° +25 XP</div>
                                <button class="activity-btn">JOIN</button>
                            </div>
                            <div class="activity-card" onclick="doActivity('party')">
                                <span class="activity-icon">üéâ</span>
                                <div class="activity-title">Campus Party</div>
                                <div class="activity-stats">-15‚ö° +20üòä +20 XP</div>
                                <button class="activity-btn">JOIN</button>
                            </div>
                            <div class="activity-card" onclick="doActivity('garden')">
                                <span class="activity-icon">üå∏</span>
                                <div class="activity-title">Botanical Garden</div>
                                <div class="activity-stats">+10‚ö° +15üòä +15 XP</div>
                                <button class="activity-btn">JOIN</button>
                            </div>
                            <div class="activity-card" onclick="openTrivia()">
                                <span class="activity-icon">üß†</span>
                                <div class="activity-title">Trivia Challenge</div>
                                <div class="activity-stats">+50üß† +100ü™ô +50 XP</div>
                                <button class="activity-btn">PLAY</button>
                            </div>
                            <div class="activity-card" onclick="openDanceGame()">
                                <span class="activity-icon">üíÉ</span>
                                <div class="activity-title">Dance Party</div>
                                <div class="activity-stats">+30üé® +20üòä +30 XP</div>
                                <button class="activity-btn">PLAY</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Campus Map Preview -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <span><i class="fas fa-map"></i> Campus Map</span>
                        <button class="btn btn-ghost" style="padding: 0.25rem 0.75rem; font-size: 0.8rem;" onclick="openFullMap()">
                            View Full
                        </button>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div style="background: linear-gradient(135deg, #e8f5e9, #c8e6c9); height: 200px; position: relative; border-radius: 0 0 20px 20px; overflow: hidden;">
                            <div style="position: absolute; top: 20%; left: 20%; width: 50px; height: 50px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: var(--shadow-md); cursor: pointer;" onclick="travelTo('library')" title="Library">üìö</div>
                            <div style="position: absolute; top: 20%; right: 20%; width: 50px; height: 50px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: var(--shadow-md); cursor: pointer;" onclick="travelTo('cafe')" title="Caf√©">‚òï</div>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 60px; height: 60px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; box-shadow: var(--shadow-md); cursor: pointer;" onclick="travelTo('center')" title="Student Center">üè¢</div>
                            <div style="position: absolute; bottom: 20%; left: 20%; width: 50px; height: 50px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: var(--shadow-md); cursor: pointer;" onclick="travelTo('gym')" title="Gym">üèãÔ∏è</div>
                            <div style="position: absolute; bottom: 20%; right: 20%; width: 50px; height: 50px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: var(--shadow-md); cursor: pointer;" onclick="travelTo('dorm')" title="Dormitory">üè†</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Sidebar -->
            <aside class="sidebar-right">
                <!-- Online Users -->
                <div class="card">
                    <div class="card-header">
                        <span><i class="fas fa-users"></i> Online Students</span>
                        <span class="badge" style="background: rgba(255,255,255,0.3); padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.85rem;" id="onlineCount">1</span>
                    </div>
                    <div class="card-body" style="padding: 0.75rem;">
                        <div class="online-list" id="onlineList">
                            <div class="online-user" onclick="whisperUser('System')">
                                <div style="position: relative;">
                                    <div class="user-avatar">ü§ñ</div>
                                    <div class="online-indicator"></div>
                                </div>
                                <div class="user-info">
                                    <div class="user-name">System</div>
                                    <div class="user-status">Bot Helper</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Card -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <span><i class="fas fa-comments"></i> Campus Chat</span>
                        <button class="btn btn-ghost" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;" onclick="clearChat()">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages">
                            <div class="message message-system">
                                Welcome to Campus Life Chat! Be kind and have fun! üå∏
                            </div>
                        </div>
                        <div class="chat-input-area" style="position: relative;">
                            <button class="btn btn-ghost" style="width: 40px; height: 40px; border-radius: 50%; padding: 0;" onclick="toggleEmojiPicker()">
                                üòä
                            </button>
                            <input type="text" class="chat-input" id="chatInput" placeholder="Type a message..." maxlength="200" onkeypress="if(event.key==='Enter')sendMessage()">
                            <button class="btn btn-primary" style="width: 40px; height: 40px; border-radius: 50%; padding: 0;" onclick="sendMessage()">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                            
                            <div class="emoji-picker" id="emojiPicker">
                                <span class="emoji-option" onclick="addEmoji('üòä')">üòä</span>
                                <span class="emoji-option" onclick="addEmoji('üòÇ')">üòÇ</span>
                                <span class="emoji-option" onclick="addEmoji('‚ù§Ô∏è')">‚ù§Ô∏è</span>
                                <span class="emoji-option" onclick="addEmoji('üéâ')">üéâ</span>
                                <span class="emoji-option" onclick="addEmoji('üî•')">üî•</span>
                                <span class="emoji-option" onclick="addEmoji('‚ú®')">‚ú®</span>
                                <span class="emoji-option" onclick="addEmoji('üëç')">üëç</span>
                                <span class="emoji-option" onclick="addEmoji('üéì')">üéì</span>
                                <span class="emoji-option" onclick="addEmoji('üìö')">üìö</span>
                                <span class="emoji-option" onclick="addEmoji('‚òï')">‚òï</span>
                                <span class="emoji-option" onclick="addEmoji('üèÄ')">üèÄ</span>
                                <span class="emoji-option" onclick="addEmoji('üå∏')">üå∏</span>
                                <span class="emoji-option" onclick="addEmoji('üíï')">üíï</span>
                                <span class="emoji-option" onclick="addEmoji('üéµ')">üéµ</span>
                                <span class="emoji-option" onclick="addEmoji('üé®')">üé®</span>
                                <span class="emoji-option" onclick="addEmoji('‚ö°')">‚ö°</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <span><i class="fas fa-bolt"></i> Quick Actions</span>
                    </div>
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <button class="btn btn-secondary" onclick="openShop()" style="font-size: 0.85rem;">
                                <i class="fas fa-shopping-bag"></i> Shop
                            </button>
                            <button class="btn btn-secondary" onclick="openJobs()" style="font-size: 0.85rem;">
                                <i class="fas fa-briefcase"></i> Jobs
                            </button>
                            <button class="btn btn-secondary" onclick="openDorm()" style="font-size: 0.85rem;">
                                <i class="fas fa-home"></i> Dorm
                            </button>
                            <button class="btn btn-secondary" onclick="openSettings()" style="font-size: 0.85rem;">
                                <i class="fas fa-cog"></i> Settings
                            </button>
                        </div>
                    </div>
                </div>
            </aside>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div>App design by Chris Heppard</div>
            <div style="font-size: 0.85rem; margin-top: 0.5rem; opacity: 0.9;">
                Campus Life Simulator v2.0 | Multiplayer Online
            </div>
        </footer>
    </div>

    <!-- Avatar Creator Modal -->
    <div class="modal-overlay" id="avatarModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('avatarModal')">&times;</button>
            <h2 style="text-align: center; margin-bottom: 1.5rem; color: var(--pink-500);">
                <i class="fas fa-user-edit"></i> Avatar Creator
            </h2>
            
            <div class="avatar-creator">
                <div>
                    <div class="avatar-preview-large" id="avatarPreview">üë§</div>
                    <div style="text-align: center;">
                        <button class="btn btn-primary" onclick="saveAvatar()" style="width: 100%;">
                            <i class="fas fa-save"></i> Save Avatar
                        </button>
                        <button class="btn btn-ghost" onclick="randomizeAvatar()" style="width: 100%; margin-top: 0.5rem;">
                            <i class="fas fa-random"></i> Randomize
                        </button>
                    </div>
                </div>
                
                <div style="max-height: 500px; overflow-y: auto;">
                    <!-- Base Face -->
                    <div class="customization-section">
                        <div class="customization-title">Base Face</div>
                        <div class="option-grid" id="faceOptions">
                            <button class="option-btn selected" onclick="selectFace('üëß', this)">üëß</button>
                            <button class="option-btn" onclick="selectFace('üë¶', this)">üë¶</button>
                            <button class="option-btn" onclick="selectFace('üë©', this)">üë©</button>
                            <button class="option-btn" onclick="selectFace('üë®', this)">üë®</button>
                            <button class="option-btn" onclick="selectFace('üßë', this)">üßë</button>
                            <button class="option-btn" onclick="selectFace('üë±‚Äç‚ôÄÔ∏è', this)">üë±‚Äç‚ôÄÔ∏è</button>
                            <button class="option-btn" onclick="selectFace('üë±‚Äç‚ôÇÔ∏è', this)">üë±‚Äç‚ôÇÔ∏è</button>
                            <button class="option-btn" onclick="selectFace('üßì', this)">üßì</button>
                        </div>
                    </div>

                    <!-- Hair Style -->
                    <div class="customization-section">
                        <div class="customization-title">Hair Style</div>
                        <div class="option-grid" id="hairOptions">
                            <button class="option-btn selected" onclick="selectHair('', this)">None</button>
                            <button class="option-btn" onclick="selectHair('üéÄ', this)">üéÄ</button>
                            <button class="option-btn" onclick="selectHair('üß¢', this)">üß¢</button>
                            <button class="option-btn" onclick="selectHair('üëí', this)">üëí</button>
                            <button class="option-btn" onclick="selectHair('üé©', this)">üé©</button>
                            <button class="option-btn" onclick="selectHair('üëë', this)">üëë</button>
                            <button class="option-btn" onclick="selectHair('üéì', this)">üéì</button>
                            <button class="option-btn" onclick="selectHair('‚õëÔ∏è', this)">‚õëÔ∏è</button>
                        </div>
                    </div>

                    <!-- Accessories -->
                    <div class="customization-section">
                        <div class="customization-title">Accessories</div>
                        <div class="option-grid" id="accessoryOptions">
                            <button class="option-btn selected" onclick="selectAccessory('', this)">None</button>
                            <button class="option-btn" onclick="selectAccessory('üëì', this)">üëì</button>
                            <button class="option-btn" onclick="selectAccessory('üï∂Ô∏è', this)">üï∂Ô∏è</button>
                            <button class="option-btn" onclick="selectAccessory('üéß', this)">üéß</button>
                            <button class="option-btn" onclick="selectAccessory('üìø', this)">üìø</button>
                            <button class="option-btn" onclick="selectAccessory('üíÑ', this)">üíÑ</button>
                            <button class="option-btn" onclick="selectAccessory('üé≠', this)">üé≠</button>
                            <button class="option-btn" onclick="selectAccessory('üíé', this)">üíé</button>
                        </div>
                    </div>

                    <!-- Background Color -->
                    <div class="customization-section">
                        <div class="customization-title">Background</div>
                        <div class="color-picker" id="colorOptions">
                            <div class="color-option selected" style="background: linear-gradient(135deg, #ffc2d1, #e0aaff);" onclick="selectColor('linear-gradient(135deg, #ffc2d1, #e0aaff)', this)"></div>
                            <div class="color-option" style="background: linear-gradient(135deg, #ff6b9d, #c77dff);" onclick="selectColor('linear-gradient(135deg, #ff6b9d, #c77dff)', this)"></div>
                            <div class="color-option" style="background: linear-gradient(135deg, #4ade80, #22c55e);" onclick="selectColor('linear-gradient(135deg, #4ade80, #22c55e)', this)"></div>
                            <div class="color-option" style="background: linear-gradient(135deg, #60a5fa, #3b82f6);" onclick="selectColor('linear-gradient(135deg, #60a5fa, #3b82f6)', this)"></div>
                            <div class="color-option" style="background: linear-gradient(135deg, #fbbf24, #f59e0b);" onclick="selectColor('linear-gradient(135deg, #fbbf24, #f59e0b)', this)"></div>
                            <div class="color-option" style="background: linear-gradient(135deg, #f87171, #ef4444);" onclick="selectColor('linear-gradient(135deg, #f87171, #ef4444)', this)"></div>
                            <div class="color-option" style="background: linear-gradient(135deg, #a78bfa, #8b5cf6);" onclick="selectColor('linear-gradient(135deg, #a78bfa, #8b5cf6)', this)"></div>
                            <div class="color-option" style="background: linear-gradient(135deg, #2dd4bf, #14b8a6);" onclick="selectColor('linear-gradient(135deg, #2dd4bf, #14b8a6)', this)"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                     GAME STATE                                ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        const GameState = {
            player: {
                name: '',
                gender: '',
                level: 1,
                xp: 0,
                coins: 500,
                gems: 10,
                avatar: 'üëß',
                hair: '',
                accessory: '',
                bgColor: 'linear-gradient(135deg, #ffc2d1, #e0aaff)',
                title: 'Freshman Student'
            },
            stats: {
                energy: 100,
                happiness: 85,
                knowledge: 42,
                social: 60,
                gpa: 3.5
            },
            skills: {
                intelligence: 10,
                charisma: 10,
                athletics: 10,
                creativity: 10
            },
            isLoggedIn: false,
            achievements: new Set(),
            inventory: ['üìö Textbook', '‚òï Coffee'],
            quests: {
                1: { progress: 60, completed: false, claimed: false },
                2: { progress: 33, completed: false, claimed: false },
                3: { progress: 100, completed: true, claimed: true }
            }
        };

        // WebSocket Connection
        let socket = null;
        let reconnectAttempts = 0;
        const MAX_RECONNECT_ATTEMPTS = 5;
        
        // For GitHub Pages deployment, you'll need to set up a separate WebSocket server
        // Update this URL to your WebSocket server address
        const WS_SERVER_URL = 'wss://your-websocket-server.com'; // Change this to your server
        
        function initWebSocket() {
            updateConnectionStatus('connecting');
            
            try {
                // For demo purposes, we'll simulate a connection
                // In production, replace with: socket = io(WS_SERVER_URL);
                
                // Simulated connection for GitHub Pages demo
                setTimeout(() => {
                    simulateConnection();
                }, 1500);
                
            } catch (error) {
                console.error('WebSocket connection failed:', error);
                updateConnectionStatus('disconnected');
                attemptReconnect();
            }
        }

        function simulateConnection() {
            // This simulates a real connection for demonstration
            // In production, this would be actual WebSocket code
            
            updateConnectionStatus('connected');
            showNotification('Connected to Campus Server!', 'success');
            
            // Simulate receiving messages from other users
            setInterval(() => {
                if (Math.random() > 0.7 && GameState.isLoggedIn) {
                    const messages = [
                        { user: 'Emma', avatar: 'üéµ', text: 'Anyone want to study together?' },
                        { user: 'Jake', avatar: 'üèÄ', text: 'Basketball at 3pm!' },
                        { user: 'Sophia', avatar: 'üé®', text: 'The art exhibit is amazing!' },
                        { user: 'System', avatar: 'ü§ñ', text: 'Daily quests have been reset!' }
                    ];
                    const msg = messages[Math.floor(Math.random() * messages.length)];
                    if (msg.user !== GameState.player.name) {
                        addMessage(msg.user, msg.text, false, msg.avatar);
                    }
                }
            }, 15000);
            
            // Simulate user joining/leaving
            setInterval(() => {
                updateOnlineCount(Math.floor(Math.random() * 10) + 5);
            }, 30000);
        }

        function attemptReconnect() {
            if (reconnectAttempts < MAX_RECONNECT_ATTEMPTS) {
                reconnectAttempts++;
                setTimeout(() => {
                    initWebSocket();
                }, 3000 * reconnectAttempts);
            } else {
                showNotification('Connection failed. Playing in offline mode.', 'warning');
                updateConnectionStatus('offline');
            }
        }

        function updateConnectionStatus(status) {
            const statusEl = document.getElementById('connectionStatus');
            const textEl = document.getElementById('connectionText');
            
            statusEl.className = 'connection-status ' + status;
            
            const statusText = {
                connecting: 'Connecting...',
                connected: 'Online',
                disconnected: 'Disconnected',
                offline: 'Offline Mode'
            };
            
            textEl.textContent = statusText[status] || status;
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                     PARTICLE SYSTEM                           ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        class ParticleSystem {
            constructor() {
                this.canvas = document.getElementById('particles-canvas');
                this.ctx = this.canvas.getContext('2d');
                this.particles = [];
                this.mouse = { x: 0, y: 0 };
                
                this.resize();
                window.addEventListener('resize', () => this.resize());
                window.addEventListener('mousemove', (e) => {
                    this.mouse.x = e.clientX;
                    this.mouse.y = e.clientY;
                });
                
                this.init();
                this.animate();
            }
            
            resize() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }
            
            init() {
                const symbols = ['üíï', 'üíñ', '‚ú®', 'üå∏', 'üí´', 'üå∫', 'ü¶ã'];
                for (let i = 0; i < 40; i++) {
                    this.particles.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height,
                        symbol: symbols[Math.floor(Math.random() * symbols.length)],
                        size: Math.random() * 20 + 10,
                        speedX: Math.random() * 0.5 - 0.25,
                        speedY: Math.random() * 0.5 - 0.25,
                        opacity: Math.random() * 0.5 + 0.1,
                        rotation: Math.random() * Math.PI * 2,
                        rotationSpeed: Math.random() * 0.02 - 0.01
                    });
                }
            }
            
            animate() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                this.particles.forEach(p => {
                    const dx = this.mouse.x - p.x;
                    const dy = this.mouse.y - p.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    
                    if (dist < 100) {
                        p.x -= dx * 0.01;
                        p.y -= dy * 0.01;
                    }
                    
                    p.x += p.speedX;
                    p.y += p.speedY;
                    p.rotation += p.rotationSpeed;
                    
                    if (p.x < 0) p.x = this.canvas.width;
                    if (p.x > this.canvas.width) p.x = 0;
                    if (p.y < 0) p.y = this.canvas.height;
                    if (p.y > this.canvas.height) p.y = 0;
                    
                    this.ctx.save();
                    this.ctx.translate(p.x, p.y);
                    this.ctx.rotate(p.rotation);
                    this.ctx.globalAlpha = p.opacity;
                    this.ctx.font = `${p.size}px Arial`;
                    this.ctx.textAlign = 'center';
                    this.ctx.textBaseline = 'middle';
                    this.ctx.fillText(p.symbol, 0, 0);
                    this.ctx.restore();
                });
                
                requestAnimationFrame(() => this.animate());
            }
        }

        new ParticleSystem();

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                     CORE FUNCTIONS                            ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        function enterCampus() {
            const nameInput = document.getElementById('playerName');
            const genderInput = document.getElementById('playerGender');
            
            GameState.player.name = nameInput.value.trim();
            GameState.player.gender = genderInput.value;
            
            if (!GameState.player.name || !GameState.player.gender) {
                showNotification('Please fill in all fields!', 'warning');
                return;
            }
            
            // Check name length
            if (GameState.player.name.length < 2) {
                showNotification('Name must be at least 2 characters!', 'warning');
                return;
            }
            
            GameState.isLoggedIn = true;
            
            // Update UI
            document.getElementById('mainContent').style.opacity = '1';
            document.getElementById('mainContent').style.pointerEvents = 'all';
            document.getElementById('displayName').textContent = GameState.player.name;
            document.getElementById('loginSection').style.display = 'none';
            
            // Set initial avatar based on gender
            const avatars = { 
                female: 'üëß', 
                male: 'üë¶', 
                other: 'üßë' 
            };
            GameState.player.avatar = avatars[GameState.player.gender] || 'üßë';
            updateAvatarDisplay();
            
            // Send login to server (if connected)
            if (socket) {
                socket.emit('user_joined', {
                    name: GameState.player.name,
                    avatar: buildAvatarString(),
                    level: GameState.player.level
                });
            }
            
            // Show tutorial for first-time users
            if (!localStorage.getItem('hasPlayed')) {
                setTimeout(() => {
                    showNotification('Welcome! Check out the Avatar Creator! üë§', 'info');
                }, 1000);
                localStorage.setItem('hasPlayed', 'true');
            }
            
            unlockAchievement('first_login');
            showNotification(`Welcome to Campus, ${GameState.player.name}! üéì`, 'success');
            
            // Add system message
            addMessage('System', `${GameState.player.name} has joined the campus! üéâ`, true, 'ü§ñ');
        }

        function doActivity(type) {
            if (!GameState.isLoggedIn) {
                showNotification('Please enter campus first!', 'warning');
                return;
            }
            
            if (GameState.stats.energy < 5) {
                showNotification('Not enough energy! Rest or drink coffee. ‚òï', 'error');
                return;
            }
            
            const activities = {
                study: { 
                    energy: -10, 
                    knowledge: 15, 
                    skill: 'intelligence', 
                    xp: 20,
                    message: 'You studied hard and learned a lot!' 
                },
                coffee: { 
                    energy: -5, 
                    social: 10, 
                    skill: 'charisma', 
                    xp: 15,
                    message: 'You had a great conversation at the caf√©!' 
                },
                club: { 
                    energy: -10, 
                    social: 15, 
                    skill: 'charisma', 
                    xp: 20,
                    message: 'Club meeting was productive!' 
                },
                sports: { 
                    energy: -20, 
                    happiness: 15, 
                    skill: 'athletics', 
                    xp: 25,
                    message: 'Great workout! You feel stronger!' 
                },
                party: { 
                    energy: -15, 
                    happiness: 20, 
                    skill: 'charisma', 
                    xp: 20,
                    message: 'You had an amazing time at the party!' 
                },
                garden: { 
                    energy: 10, 
                    happiness: 15, 
                    skill: 'creativity', 
                    xp: 15,
                    message: 'The garden is so peaceful...' 
                }
            };
            
            const act = activities[type];
            if (!act) return;
            
            // Update stats
            GameState.stats.energy = Math.min(100, Math.max(0, GameState.stats.energy + act.energy));
            GameState.stats.happiness = Math.min(100, Math.max(0, GameState.stats.happiness + (act.happiness || 0)));
            GameState.stats.knowledge = Math.min(100, Math.max(0, GameState.stats.knowledge + (act.knowledge || 0)));
            GameState.stats.social = Math.min(100, Math.max(0, GameState.stats.social + (act.social || 0)));
            
            if (act.skill) {
                GameState.skills[act.skill]++;
                document.getElementById('skill' + act.skill.charAt(0).toUpperCase() + act.skill.slice(1, 3)).textContent = GameState.skills[act.skill];
            }
            
            addXP(act.xp);
            updateStats();
            
            showNotification(`${act.message} +${act.xp} XP`, 'success');
            
            // Send to chat
            addMessage('System', `You completed: ${type}`, true, 'ü§ñ');
            
            // Update quest progress
            updateQuestProgress(type);
        }

        function addXP(amount) {
            GameState.player.xp += amount;
            const needed = GameState.player.level * 100;
            
            if (GameState.player.xp >= needed) {
                GameState.player.level++;
                GameState.player.xp -= needed;
                showNotification(`üéâ Level Up! You are now level ${GameState.player.level}!`, 'success');
                
                // Update title based on level
                if (GameState.player.level >= 10) GameState.player.title = 'Senior Student';
                else if (GameState.player.level >= 5) GameState.player.title = 'Junior Student';
                
                document.getElementById('playerTitle').textContent = GameState.player.title;
            }
            
            updateXPBar();
        }

        function updateXPBar() {
            const needed = GameState.player.level * 100;
            const percent = (GameState.player.xp / needed) * 100;
            document.getElementById('xpBar').style.width = percent + '%';
            document.getElementById('levelDisplay').textContent = GameState.player.level;
            document.getElementById('xpText').textContent = `${GameState.player.xp}/${needed}`;
        }

        function updateStats() {
            document.getElementById('statEnergy').textContent = GameState.stats.energy;
            document.getElementById('statHappy').textContent = GameState.stats.happiness;
            document.getElementById('statLevel').textContent = GameState.player.level;
            
            // Animate stat changes
            const statElements = ['statEnergy', 'statHappy', 'statLevel'];
            statElements.forEach(id => {
                const el = document.getElementById(id);
                el.style.transform = 'scale(1.2)';
                setTimeout(() => el.style.transform = 'scale(1)', 200);
            });
        }

        function updateQuestProgress(activityType) {
            // Quest 1: Study
            if (activityType === 'study' && !GameState.quests[1].claimed) {
                GameState.quests[1].progress = Math.min(100, GameState.quests[1].progress + 20);
                document.querySelector('#quest1 .quest-progress-fill').style.width = GameState.quests[1].progress + '%';
                if (GameState.quests[1].progress >= 100) {
                    GameState.quests[1].completed = true;
                    document.getElementById('quest1').classList.add('completed');
                }
            }
            
            // Quest 2: Chat (simplified)
            if (activityType === 'coffee' && !GameState.quests[2].claimed) {
                GameState.quests[2].progress = Math.min(100, GameState.quests[2].progress + 33);
                document.querySelector('#quest2 .quest-progress-fill').style.width = GameState.quests[2].progress + '%';
                if (GameState.quests[2].progress >= 100) {
                    GameState.quests[2].completed = true;
                    document.getElementById('quest2').classList.add('completed');
                }
            }
        }

        function claimQuest(questId) {
            const quest = GameState.quests[questId];
            if (!quest || !quest.completed || quest.claimed) {
                if (!quest.completed) showNotification('Quest not completed yet!', 'warning');
                return;
            }
            
            quest.claimed = true;
            
            // Give rewards
            if (questId === 1) {
                GameState.player.coins += 50;
                addXP(10);
            } else if (questId === 2) {
                GameState.player.coins += 30;
                GameState.skills.charisma += 5;
            }
            
            document.getElementById('statCoins').textContent = GameState.player.coins;
            showNotification('Quest completed! Rewards claimed! üéÅ', 'success');
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                     ACHIEVEMENT SYSTEM                        ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        function unlockAchievement(id) {
            if (GameState.achievements.has(id)) return;
            
            GameState.achievements.add(id);
            localStorage.setItem('achievements', JSON.stringify([...GameState.achievements]));
            
            const achievements = {
                first_login: { name: 'First Steps', desc: 'Enter the campus for the first time' },
                social_butterfly: { name: 'Social Butterfly', desc: 'Make 5 friends' },
                bookworm: { name: 'Bookworm', desc: 'Study 10 times' },
                rich: { name: 'Big Spender', desc: 'Earn 1000 coins' },
                popular: { name: 'Popular Kid', desc: 'Reach level 10' }
            };
            
            const ach = achievements[id];
            if (ach) {
                const toast = document.getElementById('achievementToast');
                document.getElementById('achievementName').textContent = ach.name;
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 5000);
            }
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                     CHAT SYSTEM                               ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        function sendMessage() {
            if (!GameState.isLoggedIn) {
                showNotification('Please enter campus first!', 'warning');
                return;
            }
            
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (!text) return;
            
            // Check for commands
            if (text.startsWith('/')) {
                handleCommand(text);
                input.value = '';
                return;
            }
            
            addMessage(GameState.player.name, text, true, buildAvatarString());
            input.value = '';
            
            // Send to server if connected
            if (socket) {
                socket.emit('chat_message', {
                    user: GameState.player.name,
                    text: text,
                    avatar: buildAvatarString()
                });
            }
            
            // Update quest progress for chatting
            if (!GameState.quests[2].claimed) {
                GameState.quests[2].progress = Math.min(100, GameState.quests[2].progress + 33);
                document.querySelector('#quest2 .quest-progress-fill').style.width = GameState.quests[2].progress + '%';
                if (GameState.quests[2].progress >= 100) {
                    GameState.quests[2].completed = true;
                    document.getElementById('quest2').classList.add('completed');
                }
            }
        }

        function addMessage(user, text, isSystem, avatar = 'ü§ñ') {
            const container = document.getElementById('chatMessages');
            const msg = document.createElement('div');
            
            if (isSystem && user === 'System') {
                msg.className = 'message message-system';
                msg.textContent = text;
            } else {
                const isMe = user === GameState.player.name;
                msg.className = `message ${isMe ? 'message-outgoing' : 'message-incoming'}`;
                msg.innerHTML = `
                    <div class="message-header">
                        <div class="message-avatar">${avatar}</div>
                        <span>${user}</span>
                    </div>
                    <div>${text}</div>
                `;
            }
            
            container.appendChild(msg);
            container.scrollTop = container.scrollHeight;
            
            // Limit messages
            while (container.children.length > 50) {
                container.removeChild(container.firstChild);
            }
        }

        function handleCommand(cmd) {
            const parts = cmd.split(' ');
            const command = parts[0].toLowerCase();
            
            switch(command) {
                case '/help':
                    addMessage('System', 'Commands: /help, /clear, /whisper [name] [message], /dance, /wave', true);
                    break;
                case '/clear':
                    document.getElementById('chatMessages').innerHTML = '';
                    break;
                case '/dance':
                    addMessage('System', `${GameState.player.name} is dancing! üíÉ`, true);
                    break;
                case '/wave':
                    addMessage('System', `${GameState.player.name} waves hello! üëã`, true);
                    break;
                case '/whisper':
                    if (parts.length >= 3) {
                        const target = parts[1];
                        const message = parts.slice(2).join(' ');
                        addMessage('System', `üì® Whisper to ${target}: ${message}`, true);
                    } else {
                        showNotification('Usage: /whisper [name] [message]', 'warning');
                    }
                    break;
                default:
                    showNotification('Unknown command. Type /help for help.', 'warning');
            }
        }

        function whisperUser(username) {
            const input = document.getElementById('chatInput');
            input.value = `/whisper ${username} `;
            input.focus();
        }

        function clearChat() {
            if (confirm('Clear all chat messages?')) {
                document.getElementById('chatMessages').innerHTML = '';
            }
        }

        function toggleEmojiPicker() {
            document.getElementById('emojiPicker').classList.toggle('show');
        }

        function addEmoji(emoji) {
            const input = document.getElementById('chatInput');
            input.value += emoji;
            input.focus();
        }

        function updateOnlineCount(count) {
            document.getElementById('onlineCount').textContent = count;
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                     AVATAR CREATOR                            ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        function openAvatarCreator() {
            if (!GameState.isLoggedIn) {
                showNotification('Enter campus first to customize your avatar!', 'warning');
                return;
            }
            document.getElementById('avatarModal').classList.add('show');
            updateAvatarPreview();
        }

        function selectFace(face, btn) {
            GameState.player.avatar = face;
            document.querySelectorAll('#faceOptions .option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            updateAvatarPreview();
        }

        function selectHair(hair, btn) {
            GameState.player.hair = hair;
            document.querySelectorAll('#hairOptions .option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            updateAvatarPreview();
        }

        function selectAccessory(acc, btn) {
            GameState.player.accessory = acc;
            document.querySelectorAll('#accessoryOptions .option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            updateAvatarPreview();
        }

        function selectColor(color, el) {
            GameState.player.bgColor = color;
            document.querySelectorAll('.color-option').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            updateAvatarPreview();
        }

        function updateAvatarPreview() {
            const preview = document.getElementById('avatarPreview');
            preview.textContent = GameState.player.avatar;
            preview.style.background = GameState.player.bgColor;
        }

        function buildAvatarString() {
            // Combine avatar parts
            let avatar = GameState.player.avatar;
            if (GameState.player.hair) avatar += GameState.player.hair;
            if (GameState.player.accessory) avatar += GameState.player.accessory;
            return avatar;
        }

        function updateAvatarDisplay() {
            const display = document.getElementById('profileAvatar');
            display.textContent = buildAvatarString();
            display.style.background = GameState.player.bgColor;
        }

        function saveAvatar() {
            updateAvatarDisplay();
            closeModal('avatarModal');
            showNotification('Avatar saved! ‚ú®', 'success');
            
            // Update in chat if connected
            if (socket) {
                socket.emit('avatar_updated', {
                    avatar: buildAvatarString(),
                    bgColor: GameState.player.bgColor
                });
            }
        }

        function randomizeAvatar() {
            const faces = ['üëß', 'üë¶', 'üë©', 'üë®', 'üßë', 'üë±‚Äç‚ôÄÔ∏è', 'üë±‚Äç‚ôÇÔ∏è'];
            const hairs = ['', 'üéÄ', 'üß¢', 'üëí', 'üé©', 'üëë', 'üéì'];
            const accessories = ['', 'üëì', 'üï∂Ô∏è', 'üéß', 'üìø', 'üíÑ'];
            const colors = [
                'linear-gradient(135deg, #ffc2d1, #e0aaff)',
                'linear-gradient(135deg, #ff6b9d, #c77dff)',
                'linear-gradient(135deg, #4ade80, #22c55e)',
                'linear-gradient(135deg, #60a5fa, #3b82f6)',
                'linear-gradient(135deg, #fbbf24, #f59e0b)',
                'linear-gradient(135deg, #f87171, #ef4444)'
            ];
            
            GameState.player.avatar = faces[Math.floor(Math.random() * faces.length)];
            GameState.player.hair = hairs[Math.floor(Math.random() * hairs.length)];
            GameState.player.accessory = accessories[Math.floor(Math.random() * accessories.length)];
            GameState.player.bgColor = colors[Math.floor(Math.random() * colors.length)];
            
            // Update UI selections
            updateAvatarPreview();
            showNotification('Random avatar generated! üé≤', 'success');
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        /* ‚ïë                     UTILITY FUNCTIONS                         ‚ïë */
        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existing = document.querySelectorAll('.notification');
            existing.forEach(n => n.remove());
            
            const toast = document.createElement('div');
            toast.className = `notification ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('show');
            // Close emoji picker if open
            document.getElementById('emojiPicker').classList.remove('show');
        }

        function toggleTheme() {
            document.body.classList.toggle('light-theme');
            const isLight = document.body.classList.contains('light-theme');
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
        }

        function openTrivia() {
            showNotification('Trivia Challenge coming in v2.1! üß†', 'info');
        }

        function openDanceGame() {
            showNotification('Dance Party coming in v2.1! üíÉ', 'info');
        }

        function openShop() {
            showNotification('Campus Shop coming soon! üõçÔ∏è', 'info');
        }

        function openJobs() {
            showNotification('Part-time Jobs coming soon! üíº', 'info');
        }

        function openDorm() {
            showNotification('Dorm Room customization coming soon! üè†', 'info');
        }

        function openSettings() {
            showNotification('Settings panel coming soon! ‚öôÔ∏è', 'info');
        }

        function showActivityHelp() {
            showNotification('Click any activity to join! Each activity costs energy but gives rewards.', 'info');
        }

        function openFullMap() {
            showNotification('Full campus map coming soon! üó∫Ô∏è', 'info');
        }

        function travelTo(location) {
            const names = {
                library: 'Library',
                cafe: 'Caf√©',
                center: 'Student Center',
                gym: 'Gym',
                dorm: 'Dormitory'
            };
            showNotification(`Traveled to ${names[location] || location}! üö∂`, 'success');
            
            // Auto-trigger activity
            if (location === 'library') doActivity('study');
            if (location === 'cafe') doActivity('coffee');
            if (location === 'gym') doActivity('sports');
        }

        // Energy regeneration
        setInterval(() => {
            if (GameState.isLoggedIn && GameState.stats.energy < 100) {
                GameState.stats.energy = Math.min(100, GameState.stats.energy + 5);
                updateStats();
            }
        }, 60000);

        // Load saved data
        window.addEventListener('load', () => {
            initWebSocket();
            
            // Load theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.remove('light-theme');
            }
            
            // Load achievements
            const savedAch = localStorage.getItem('achievements');
            if (savedAch) {
                GameState.achievements = new Set(JSON.parse(savedAch));
            }
        });

        // Close emoji picker when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.chat-input-area')) {
                document.getElementById('emojiPicker').classList.remove('show');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal-overlay.show').forEach(m => m.classList.remove('show'));
                document.getElementById('emojiPicker').classList.remove('show');
            }
        });
    </script>
</body>
</html>
